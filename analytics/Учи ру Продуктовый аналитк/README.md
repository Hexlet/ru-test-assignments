# SQL

*(Для каждого задания надо написать sql-скрипт. Примерное время выполнения задания - 1 час)*

## 1. Задача №1

В Учи.ру дети решают задания, доступ к заданиям платный. Однако учитель может включить функцию "Урок", и в течение часа все задания станут бесплатными.

Написать SQL-запрос, чтобы посчитать количество учеников, у которых доля заданий, решенных во время функции "Урок" составляет больше 50% от общего числа решенных заданий.

Структура таблиц:

**sessions**
    • card_id – ID решенного задания
    • session_time – дата решения задания YYYY-MM-DD hh:mm:ss
    • user_id – ID ученика
    • teacher_id – ID учителя

**lessons**
    • teacher_id – ID учителя
    • lesson_start – дата в формате YYYY-MM-DD hh:mm:ss, начиная с которой функиця "Урок" включена
    • lesson_end – дата в формате YYYY-MM-DD hh:mm:ss, когда функция "Урок" закончилась

## 2. Задача №2. Выделение сессий

Есть таблица с логами ивентов:

**events**
    • user_id (int) – ID пользователя
    • event (text) – название ивента
    • timest (timestamp) – дата и время совершения ивента

Надо написать запрос, с помощью которого можно будет получить такую же по структуре таблицу, но с 4-ой колонкой: session_id. За границу для одной сессии можно взять 30 минут (то есть если между двумя действиями пользователя проходит более 30 минут, то они принадлежат разным сессиям).

## Продуктовая аналитика

*(Для каждого задания надо написать краткий ответ, 3-4 предложения, не больше. Примерное время выполнения задания - 1 час)*

## 1. Проверка гипотезы без АБ

На Учи.Ру есть механика “Марафон”: дети в классе должны решить за месяц как можно больше заданий, классы соревнуются друг с другом. Механика побуждает детей решать больше заданий и, соответственно, увеличивает выручку компании. Есть гипотеза, что каждый новый Марафон (проводятся они раз в месяц) дает все меньший и меньший эффект (то есть эффект затухает). Как можно проверить эту гипотезу, без проведения АБ-теста?

## 2. Метрики игры

Одна из гипотез, как мы можем увеличить активность на платформе, это геймификация. Идея: добавить на сайт игру, где можно будет тратить внутреннюю валюту, которую можно заработать решая задания. Какие метрики успеха (а лучше, иерархию) Вы могли бы здесь предложить?

## 3. Неудачный онбординг

Мы тестировали новый онбординг, который по итогу не вырастил общую конверсию, но при этом статзначимо поднял конверсию из регистрации в решение заданий, но уронил конверсию из страницы тарифов в оплату. Как можно продуктово объяснить, что конкретно произошло и почему мы упали на этапе перехода в оплату? (Этапы воронки последователи)

|Этап конверсии |control |target |p-value|
|---------------|--------|-------|-------|
|Зарегистрирован -> начал решать контент |70% |83% |0.02|
|Начал решать контент -> закончил решать бесплатную часть |95% |96% |0.87|
|Закончил решать бесплатную часть -> перешел на страницу тарифов |19% |18% |0.93|
|Перешел на страницу тарифов -> Купил |30% |26% |0.01|
|Зарегистрирован -> купил |3.8% |3.7% |0.89|
